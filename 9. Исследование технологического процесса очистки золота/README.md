# [Исследование технологического процесса очистки золота](https://github.com/Urchien/Yandex_Practicum/blob/main/9.%20%D0%98%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%B0%20%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B8%20%D0%B7%D0%BE%D0%BB%D0%BE%D1%82%D0%B0/Recovery_of_gold_from_ore_review_final.ipynb) |

## Статус проекта - завершен.

## Описание проекта

Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Описание данных 

Для исследования получен csv-файл gold_industry_full.csv


**Технологический процесс**

- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
    - Xanthate — ксантогенат (промотер, или активатор флотации);
    - Sulphate — сульфат (на данном производстве сульфид натрия);
    - Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

**Параметры этапов**

- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи


**Наименование признаков должно быть такое:**

[этап].[тип_параметра].[название_параметра]

Пример: rougher.input.feed_ag

**Возможные значения для блока [этап]:**

- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики

**Возможные значения для блока [тип_параметра]:**

- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики

## Задачи проекта

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

## План работ:

- 1. Подготовьте данные
    - Открыть файлы и изучить их.
    - Проверить, что эффективность обогащения рассчитана правильно. Вычислить её на обучающей выборке для признака rougher.output.recovery. Найти MAE между нашими расчётами и значением признака. Описать выводы.
    - Проанализировать признаки, недоступные в тестовой выборке. Что это за параметры? К какому типу относятся?
    - Провести предобработку данных.
- 2. Проанализировать данные
    - Посмотреть, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате. Какие особенности имеют распределения? Описать выводы.
    - Сравнить распределения размеров гранул исходного сырья на обучающей и тестовой выборках. Если распределения сильно отличаются друг от друга, оценка модели будет неправильной.
    - Исследовать суммарную концентрацию металлов на разных стадиях: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате.
- 3. Построить модель
    - Написать функцию для вычисления итоговой sMAPE.
    - Обучить разные модели и оценить их качество кросс-валидацией. Выбрать лучшую модель и проверить её на тестовой выборке. Описать выводы.

## Примененные инструменты

- Pandas
- Numpy
- Matplotlib
- Seaborn
- Scikit-learn
- Scipy

## Результаты исследования

В этом проекте мы:
- При подготовке данных:
    - Расчитали MAE(cреднюю абсолютную ошибку) между нашими расчётами и значением признака эффективности обогащения чернового концентрата в результате флотации - 9.83758577644259. МАЕ маленькая, следовательно формулу и расчеты мы можем считать верными.
    - Нашли 34 признака отсутствующих в тестовой выборке. Среди них целевые признаки rougher.output.recovery и final.output.recovery.
    - Заполнили пропущенные значения методом 'ffill'
- При анализе данных:
    - Исследовали изменение концентрации элементов на каждом этапе и обнаружили, что концентрация золота после каждого этапа очитски постепенно увеличивается. Для этапов начиная с флотации нашли аномальные значения около нуля и удалили их.
    - Проанализировали распределения размеров гранул на обучающей и тестовой выборках и обнаружили, что что для обоих признаков распределения практически совпадают, но есть различия в количестве наблюдений.
    - Обнаружили, что суммарная концентрация металлов увеличивается к финальному этапу. 
- При построении модель прогнозирования:
    - Написали функцию для вычисления итогового sMAPE.
    - Построили константную dummy модель для сравнения. Итоговый sMAPE для константного предсказания - 8.471904.
    - Обучили и проверили модели LinearRegression, RandomForestRegressor, GradientBoostingRegressor, DecisionTreeRegressor.
    - Выбрали RandomForestRegressor как лучшую модель. Итоговый sMAPE на тренировочной выборке - 5.891923.
    - Проверили качество RandomForestRegressor на тестовой выборке. Итоговый sMAPE на тестовой выборке - 5.675538.


**Модель при тестировании показала хорошую метрику sMAPE  по сравнению с тренировочной и темболее с константной и готова к копке золота =)**
