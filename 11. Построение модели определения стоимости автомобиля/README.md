# [Построение модели определения стоимости автомобиля](https://github.com/Urchien/Yandex_Practicum/blob/main/11.%20%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F%20%D1%81%D1%82%D0%BE%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B8%20%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%BE%D0%B1%D0%B8%D0%BB%D1%8F/Determining_the_cost_of_cars.ipynb)

## Статус проекта - завершен.

## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости. 

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

## Описание данных 

Для исследования получен csv-файл autos.csv который содержит следующие признаки:

- Признаки
    - DateCrawled — дата скачивания анкеты из базы
    - VehicleType — тип автомобильного кузова
    - RegistrationYear — год регистрации автомобиля
    - Gearbox — тип коробки передач
    - Power — мощность (л. с.)
    - Model — модель автомобиля
    - Kilometer — пробег (км)
    - RegistrationMonth — месяц регистрации автомобиля
    - FuelType — тип топлива
    - Brand — марка автомобиля
    - Repaired — была машина в ремонте или нет
    - DateCreated — дата создания анкеты
    - NumberOfPictures — количество фотографий автомобиля
    - PostalCode — почтовый индекс владельца анкеты (пользователя)
    - LastSeen — дата последней активности пользователя
- Целевой признак
    - Price — цена (евро)

# План работ:

1. Загрузить и изучить данные. 
2. Заполнить пропущенные значения и обработать аномалии в столбцах. Если среди признаков имеются неинформативные, удалить их.
2. Подготовить выборки для обучения моделей.
4. Обучить разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели попробовать разные гиперпараметры.
5. Проанализировать время обучения, время предсказания и качество моделей.
6. Опираясь на критерии заказчика, выбрать лучшую модель, проверить её качество на тестовой выборке.

## Примененные инструменты

- Python
- Pandas
- Numpy
- Matplotlib
- Seaborn
- Scikit-learn
- Os
- Re
- Lightgbm
- Catboost

## Результаты исследования

Работая над проектом мы:
- Загрузили и изучили данные.
- Заполнили пропущенные значения и обработать аномалии в признаках. Удалили неинформативные признаки.
- Подготовили выборки для обучения моделей.
- Обучили модели:
    - линейные: LinearRegression и Ridge
    - бустинги: LGBMRegressor, CatBoostRegressor и GradientBoostingRegressor
- Проанализировали время обучения, время предсказания и качество моделей.
- Лучше всего себя себя показал LGBMRegressor:
    - На тренировочной выборке: RMSE: 1357.08, Время подбора гиперпараметров: 00:01:30, Время обучения: 00:00:03, Время предсказания: 00:00:01
    - На тестовой выборке: RMSE: 1499.78, Время предсказания: 00:00:00

**Опираясь на критерии заказчика, и проверив качество модели на тестовой выборке, мы можем рекомендовать сервису по продаже автомобилей с пробегом «Не бит, не крашен» обученую модель LGBMRegressor с ошибкой предсказания 1510.32 евро. Для сравнения у константной модели ошибка предсказания 4657.45 евро.**
