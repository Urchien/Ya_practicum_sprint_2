# [Обучение модели классификации комментариев](https://github.com/Urchien/Yandex_Practicum/blob/main/14.%20%D0%9E%D0%B1%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8%20%D0%BA%D0%BE%D0%BC%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%80%D0%B8%D0%B5%D0%B2/toxic_comments_detection.ipynb)

## Статус проекта - завершен.

## Описание проекта

Интернет-магазин «Викишоп» запускает новый сервис. Теперь пользователи могут редактировать и дополнять описания товаров, как в вики-сообществах. То есть клиенты предлагают свои правки и комментируют изменения других. Магазину нужен инструмент, который будет искать токсичные комментарии и отправлять их на модерацию.

## Описание данных

Данные находятся в файле toxic_comments.csv
Признак text в нём содержит текст комментария, а toxic — целевой признак.

## Задачи проекта

Обучить модель классифицировать комментарии на позитивные и негативные со значением метрики качества F1 не меньше 0.75. В нашем распоряжении набор данных с разметкой о токсичности правок.

## Примененные инструменты

- Python
- Pandas
- Numpy
- Matplotlib
- Seaborn
- Scikit-learn
- Gs
- Os
- Pickle
- Requests
- String
- WordCloud
- Tqdm
- PyTorch
- Transformers
- Scipy
- Nltk
- Xgboost
- Catboost
- Lightgbm
- BERT

## План работы:

1. Подготовить данные для машинного обучения
2. Создать несколько видов ML моделей 
3. Выбрать лучший алгоритм по метрике F1, на его основе по тестовой выборке сформировать предсказание и посчитать контрольную метрику
4. Подвести итог проделанной работе

## Результаты исследования

В этом проекте мы:
- Загрузили и описали данные.
- Подготовили данные для машинного обучения, используя следующие методы:
    - Создали эмбеддинги на основе имеющихся данных при помощи BERT
    - Сформировали корпус текстов применив метод TF-IDF
    - Визуализировали наши данные, что позволило нам предположить поведение алгоритмов машинного обучения.
- Выбрали 4 модели машинного обучения:
    - линейные: Logistic Regression и LinearSVC
    - Random Forest и XGBClassifier
- Проверили их работу по метрике значениям метрики F1, полученным на кросс-валидации.
- Протестировали лучшую модель на тестовой выборке и сравнили с константным предсказанием.

Лучшая модель Logistic Regression показала: 
- F1 на тестовой выборке 0.79 
- Precision на тестовой выборке 0.78
- Recall на тестовой выборке 0.79

**Анализ результатов позволяет заключить, что обученная нами модель является эффективной и может быть использована интернет магазином "Викишоп" для поиска токсичных комментариев. Это станет важным инструментом повышения уровня обслуживания клиентов.**